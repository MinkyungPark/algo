# [Gold III] 소문난 칠공주 - 1941 

[문제 링크](https://www.acmicpc.net/problem/1941) 

---

### 풀이

- 2차원 십자 모양 경로 같은 경우는 DFS 한번으로 탐색할 수 없음
- 1차원으로 변경해서 모든 경우가 탐색 가능하도록 해야함
- 문제 풀이
	- 2차원으로 dfs시 십자모양 탐색 X
	- 1차원 리스트로 변경하고 모든 가능한 조합을 구함
	- 조합을 구하는 과정 중 'Y'가 4개 이상이면 컷
	- 'Y'가 3개 이하를 만족하는 7개의 조합을 구했다면 BFS로 인접한지 확인
	- * route + [j] 대신 append/pop으로 리스트 복사 제거
	- * sum([ ... ]) O(len(route)) 대신 y_cnt를 매개변수로 들고 다니기

	```python
	from collections import deque

	batch = [input() for _ in range(5)]

	def bfs(lis):
		visited = [[1] * 5 for _ in range(5)]
		for pos in lis[1:]:
			x, y = pos // 5, pos % 5
			visited[x][y] = 0
		
		visit_cnt = 1
		q = deque([(lis[0] // 5, lis[0] % 5)])
		while q:
			x, y = q.popleft()
			for dx, dy in zip([0, 1, -1, 0], [1, 0, 0, -1]):
				nx, ny = x + dx, y + dy
				if (
					0 <= nx < 5 and 
					0 <= ny < 5 and 
					not visited[nx][ny]
				):
					q.append((nx, ny))
					visit_cnt += 1
					visited[nx][ny] = 1
		
		return visit_cnt == 7

	def dfs(pos, route, y_cnt):
		global cnt
		# backtrack
		if y_cnt > 3:
			return
		
		# check adjacency
		if len(route) == 7:
			if bfs(route):
				cnt += 1
			return

		for i in range(pos, 25):
			route.append(i)
			dfs(i + 1, route, y_cnt + int(batch[i // 5][i % 5] == 'Y'))
			route.pop()
			
	cnt = 0
	# combinations
	dfs(0, [], 0)
	print(cnt)
	```

- Advanced
	- 푼 방법은 연결여부를 나중에 고려함 25C7(=480,700) 모든 조합을 끝까지 만든 뒤에, 매번 BFS로 연결성 검사
	- 처음부터 '연결된 7명'만 만들도록 탐색하여 조합 공간으로 줄이기
	- 비트마스크 + frontier 확장 (이미 선택한 칸들과 인접한 칸들만 다음 후보로 유지하면서 탐색)
	- 여기서 쓰인 비트마스크: 원소 수가 고정되고, 집합 연산이 많이 필요한 경우, 집합 대신 표현

---

### 성능 요약

메모리: 110980 KB, 시간: 104 ms

### 분류

수학, 그래프 이론, 브루트포스 알고리즘, 그래프 탐색, 조합론, 너비 우선 탐색, 백트래킹

### 제출 일자

2026년 1월 25일 23:02:11

### 문제 설명

<p>총 25명의 여학생들로 이루어진 여학생반은 5×5의 정사각형 격자 형태로 자리가 배치되었고, 얼마 지나지 않아 이다솜과 임도연이라는 두 학생이 두각을 나타내며 다른 학생들을 휘어잡기 시작했다. 곧 모든 여학생이 ‘이다솜파’와 ‘임도연파’의 두 파로 갈라지게 되었으며, 얼마 지나지 않아 ‘임도연파’가 세력을 확장시키며 ‘이다솜파’를 위협하기 시작했다.</p>

<p>위기의식을 느낀 ‘이다솜파’의 학생들은 과감히 현재의 체제를 포기하고, ‘소문난 칠공주’를 결성하는 것이 유일한 생존 수단임을 깨달았다. ‘소문난 칠공주’는 다음과 같은 규칙을 만족해야 한다.</p>

<ol>
	<li>이름이 이름인 만큼, 7명의 여학생들로 구성되어야 한다.</li>
	<li>강한 결속력을 위해, 7명의 자리는 서로 가로나 세로로 반드시 인접해 있어야 한다.</li>
	<li>화합과 번영을 위해, 반드시 ‘이다솜파’의 학생들로만 구성될 필요는 없다.</li>
	<li>그러나 생존을 위해, ‘이다솜파’가 반드시 우위를 점해야 한다. 따라서 7명의 학생 중 ‘이다솜파’의 학생이 적어도 4명 이상은 반드시 포함되어 있어야 한다.</li>
</ol>

<p>여학생반의 자리 배치도가 주어졌을 때, ‘소문난 칠공주’를 결성할 수 있는 모든 경우의 수를 구하는 프로그램을 작성하시오.</p>

### 입력 

 <p>'S'(이다‘솜’파의 학생을 나타냄) 또는 'Y'(임도‘연’파의 학생을 나타냄)을 값으로 갖는 5*5 행렬이 공백 없이 첫째 줄부터 다섯 줄에 걸쳐 주어진다.</p>

### 출력 

 <p>첫째 줄에 ‘소문난 칠공주’를 결성할 수 있는 모든 경우의 수를 출력한다.</p>

